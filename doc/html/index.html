<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Viscoelastic Fault -  Viscous approach: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Viscoelastic Fault -  Viscous approach
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Viscoelastic Fault - Viscous approach Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p>This code simulates the deformation of a viscoelastic medium in presence of a discrete fault under the anti-plane shear approximation. Under this assumption there is no displacement in the modeled plane <img class="formulaInl" alt="$(v_{x}=v_{y}=0)$" src="form_0.png"/> and there is no spatial variation in the direction perpendicular to the modeled plane <img class="formulaInl" alt="$(\partial z=0)$" src="form_1.png"/>. If the case of a uniform shear modulus and shear viscosity, the problem is reduced to the Poisson equation where the right-hand side depends on the velocity values from the previous time step.</p>
<dl class="section note"><dt>Note</dt><dd>This code has been modified from deall.II tutorial <a href="https://www.dealii.org/8.2.0/doxygen/deal.II/step_31.html">step-31</a>.</dd></dl>
<h2><a class="anchor" id="equations"></a>
Viscoelastic approximation</h2>
<p>We are interested in a system in which large deformations occur. In addition, we would like to take advantage of the methods that have already been studied. Therefore, we will try to adapt the equations that drive our problem so they resemble fluid flow equations, for which extensive research has been done regarding finite element methods and solving algorithms. For such purpose, we will start with the equation of conservation of momentum for an incompressible fluid: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\partial_i{(\sigma_{ij})}=f_j\]" src="form_2.png"/>
</p>
<p> where <img class="formulaInl" alt="$i$" src="form_3.png"/> and <img class="formulaInl" alt="$j$" src="form_4.png"/> run from 1 to 3 and designate spatial coordinate, <img class="formulaInl" alt="$\sigma$" src="form_5.png"/> is the stress tensor and <img class="formulaInl" alt="$f$" src="form_6.png"/> is the total external force, in this case, only the gravitational force <img class="formulaInl" alt="$f_j=f^g_j=\rho g \left(1-\alpha T \right) \delta_{iy}$" src="form_7.png"/>. The total stress can be separated in the deviatoric component <img class="formulaInl" alt="$\tau_{ij}$" src="form_8.png"/> and pressure <img class="formulaInl" alt="$P$" src="form_9.png"/>: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sigma_{ij} = \tau_{ij}-P \delta_{ij} \]" src="form_10.png"/>
</p>
<p>and the equation of conservation of motion will be: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\partial_i \tau_{ij} - \partial_j P = \rho g \left( 1 - \alpha T \right) \delta_{jy} \]" src="form_11.png"/>
</p>
<p>Since we are going to use a semi-viscous approach we need a constitutive equation to relate the deviatoric stress and strain rate. For that, we will follow the approach from <a class="el" href="citelist.html#CITEREF_moresi_et_al_02">[1]</a> and <a class="el" href="citelist.html#CITEREF_moresi_et_al_03">[2]</a> and consider that the total deformation is acomodated by a linear combination of elastic and viscous deformation: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \dot \varepsilon = \dot \varepsilon^e + \dot \varepsilon^v = \frac{\check{\tau}}{2\mu} + \frac{\tau}{2\eta} \]" src="form_12.png"/>
</p>
<p>where <img class="formulaInl" alt="$\dot\varepsilon$" src="form_13.png"/> is the strain rate, <img class="formulaInl" alt="$\check{\tau}$" src="form_14.png"/> is the Jaumann corotatonal stress rate for an element of the continuum, <img class="formulaInl" alt="$\mu$" src="form_15.png"/> is the shear modulus and <img class="formulaInl" alt="$\eta$" src="form_16.png"/> is shear viscosity. The strain rate can be expressed in terms of the velocity of the continuum <img class="formulaInl" alt="$u$" src="form_17.png"/>: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \dot \varepsilon_{ij} = \frac{1}{2} \left( \partial_j v_i + \partial_i v_j \right) \]" src="form_18.png"/>
</p>
<p>The Jaumann derivative is an observer independent objective rate (see /cite harder_91 for a discussion about the effect of using different objective derivatives on convection solutions). Jaumann stress can be expressed as: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \check{\tau} = \frac{D\tau}{Dt}+\tau\omega-\omega\tau\]" src="form_19.png"/>
</p>
<p>where <img class="formulaInl" alt="$\omega$" src="form_20.png"/> is the material spin tensor, which can be expressed in terms of the velocity: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\omega_{ij} = \frac{1}{2} \left( \partial_j v_i - \partial_i v_j \right) \]" src="form_21.png"/>
</p>
<h2><a class="anchor" id="num_approach"></a>
Numerical approach</h2>
<p>To use a semi-viscous approach we need to manipulate the constitutive equation to write the deviatoric stress in terms of the strain rate (therefore in terms of derivatives of the velocity) and the substitute it in the momentum equation. This will give us an PDE of the velocities, which we will have to solve.To achieve this, the first step is to express the Jaumann stress rate as a first order difference form: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\check{\tau} = \frac{\tau^t - \tau ^{t-1}}{\Delta t} + \tau^{t-1}\omega^{t-1} - \omega^{t-1}\tau^{t-1} \]" src="form_22.png"/>
</p>
<p>where the superscript <img class="formulaInl" alt="$t$" src="form_23.png"/> indicates the current time step and <img class="formulaInl" alt="$t-1$" src="form_24.png"/> the previous one, and <img class="formulaInl" alt="$\Delta t$" src="form_25.png"/> is the time increment during the last step. The deviatoric stress tensor for the current time step can therefore be expressed in terms of the current strain rate and past deviatoric stress and material spin tensors: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \tau^t = 2 \eta_{ef} \dot\varepsilon^t + \eta_{ef} \left[\frac{1}{\mu\Delta t} \tau ^{t-1} + \frac {1}{\mu} \left( \omega^{t-1}\tau^{t-1} - \tau^{t-1}\omega^{t-1} \right) \right] \]" src="form_26.png"/>
</p>
<p>where <img class="formulaInl" alt="$\eta_{ef}$" src="form_27.png"/> is an effective viscosity that depends on both the elastic and viscous coefficients: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \eta_{ef} = \eta \frac{\mu \Delta t}{\mu \Delta t + \eta} \]" src="form_28.png"/>
</p>
<p>Using this in the momentum equation we obtain: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_i \left(2 \eta_{ef} \dot\varepsilon_{ij} \right) - \partial_j P = f^g_j - \partial_i \left\{ \eta_{ef} \left[\frac{1}{\mu\Delta t} \tau ^{t-1}_{ij} + \frac {1}{\mu} \left( \omega^{t-1}_{ik}\tau^{t-1}_{kj} - \tau^{t-1}_{ik}\omega^{t-1}_{kj} \right) \right] \right\} \]" src="form_29.png"/>
</p>
<p>This equation is very similar to the equation of conservation of momentum for an incompressible fluid, but the discretization of the stress rate has included an additional internal elastic force force that depends on the stress and material spin from the previous time steps. If we define this internal elastic force the divergence of the second-order tensor <img class="formulaInl" alt="$ g^e_{ij}$" src="form_30.png"/>: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ f^e_j = -\partial_i g^e_{ij} = -\partial_i \left\{ \eta_{ef} \left[\frac{1}{\mu\Delta t} \tau ^{t-1}_{ij} + \frac {1}{\mu} \left( \omega^{t-1}_{ik}\tau^{t-1}_{kj} - \tau^{t-1}_{ik}\omega^{t-1}_{kj} \right) \right] \right\} \]" src="form_31.png"/>
</p>
<p>the PDE we need to solve is simply: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_i \left(2 \eta_{ef} \dot\varepsilon_{ij} \right) - \partial_j P = f^g_j + f^e_j \]" src="form_32.png"/>
</p>
<p>Therefore, we will follow the next scheme to solve the problem:</p>
<ol type="1">
<li>Input initial conditions for the stress <img class="formulaInl" alt="$\tau^0$" src="form_33.png"/> and velocity <img class="formulaInl" alt="$v^0$" src="form_34.png"/>.</li>
<li>Compute the initial material spin <img class="formulaInl" alt="$\omega^0(v^0)$" src="form_35.png"/>.</li>
<li>Compute the internal elastic force that will be used in the firts time step <img class="formulaInl" alt="$f^{e^1}_j = \partial_i g^{e^1}_{ij}(\tau^0,\omega^0)$" src="form_36.png"/>.</li>
<li>Solve the momentum equation to obtain the velocity of the first time step <img class="formulaInl" alt="$v^1$" src="form_37.png"/>.</li>
<li>Compute the strain rate of the first time step <img class="formulaInl" alt="$\dot\varepsilon^1(v^1)$" src="form_38.png"/>, stress <img class="formulaInl" alt="$\tau^1(\dot{\varepsilon}^1,\tau^0,\omega^0)$" src="form_39.png"/> and the material spin <img class="formulaInl" alt="$\omega^1(v^1)$" src="form_40.png"/>.</li>
<li>Repeat steps 3 to 5.</li>
</ol>
<h3><a class="anchor" id="anti_plane"></a>
Anti-plane shear approximation</h3>
<p>The last equation is valid for elastic problems in any dimensions. However, solving it can be computationally demanding. For certain problems it is enough to solve the equiation under certain approximations. In this case we are going to model the displacement in the <img class="formulaInl" alt="$x-y$" src="form_41.png"/> plane produced by a fault that runs parallel to the <img class="formulaInl" alt="$y-z$" src="form_42.png"/> plane and is sliding parallel to the <img class="formulaInl" alt="$z$" src="form_43.png"/> direction. </p>
<div class="image">
<img src="aps.png" alt="aps.png"/>
<div class="caption">
Figure 1: Schematic representation of a fault and the modeled plane</div></div>
 In this case, we can considered that displacement only occurs in the <img class="formulaInl" alt="$z$" src="form_43.png"/> direction <img class="formulaInl" alt="$(v_{x}=v_{y}=0)$" src="form_0.png"/>. Moreover, under this approximation no magnitude can vary along the <img class="formulaInl" alt="$z$" src="form_43.png"/> direction <img class="formulaInl" alt="$(\frac{\partial}{\partial z}=0)$" src="form_44.png"/>. Therefore, under this approximation <img class="formulaInl" alt="$\varepsilon_{xx}=\varepsilon_{yy}=\varepsilon_{zz}=\varepsilon_{xy}=\varepsilon_{yx}=0$" src="form_45.png"/> and <img class="formulaInl" alt="$\omega_{xx}=\omega_{yy}=\omega_{zz}=\omega_{xy}=\omega_{yx}=0$" src="form_46.png"/> and the governing equations are reduced to: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[-\partial_x P = f^e_x \]" src="form_47.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[-\partial_y P = f^g_y + f^e_y \]" src="form_48.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[\partial_x(2\eta_{ef}\varepsilon_{xz})+\partial_y(2\eta_{ef}\varepsilon_{yz})=f^e_z\]" src="form_49.png"/>
</p>
<p>where </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[f^e_x = -\partial_x \left\{\eta_{ef}\left[ \frac{1}{\mu\Delta t} \tau^{t-1}_{xx} + \frac{1}{\mu} \left(\omega^{t-1}_{xz}\tau^{t-1}_{zx} - \tau^{t-1}_{xz}\omega^{t-1}_{zx} \right) \right] \right\} -\partial_y \left\{\eta_{ef}\left[ \frac{1}{\mu\Delta t} \tau^{t-1}_{yx} + \frac{1}{\mu} \left(\omega^{t-1}_{yz}\tau^{t-1}_{zx} - \tau^{t-1}_{yz}\omega^{t-1}_{zx} \right) \right] \right\} \]" src="form_50.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[f^e_y = -\partial_x \left\{\eta_{ef}\left[ \frac{1}{\mu\Delta t} \tau^{t-1}_{xy} + \frac{1}{\mu} \left(\omega^{t-1}_{xz}\tau^{t-1}_{zy} - \tau^{t-1}_{xz}\omega^{t-1}_{zy} \right) \right] \right\} -\partial_y \left\{\eta_{ef}\left[ \frac{1}{\mu\Delta t} \tau^{t-1}_{yy} + \frac{1}{\mu} \left(\omega^{t-1}_{yz}\tau^{t-1}_{zy} - \tau^{t-1}_{yz}\omega^{t-1}_{zy} \right) \right] \right\} \]" src="form_51.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[f^e_z = -\partial_x \left\{\eta_{ef}\left[ \frac{1}{\mu\Delta t} \tau^{t-1}_{xz} + \frac{1}{\mu} \left(\omega^{t-1}_{xz}\tau^{t-1}_{zz} - \tau^{t-1}_{xx}\omega^{t-1}_{xz} - \tau^{t-1}_{xy}\omega^{t-1}_{yz} \right) \right] \right\} -\partial_y \left\{\eta_{ef}\left[ \frac{1}{\mu\Delta t} \tau^{t-1}_{yz} + \frac{1}{\mu} \left(\omega^{t-1}_{yz}\tau^{t-1}_{zz} - \tau^{t-1}_{yx}\omega^{t-1}_{xz} - \tau^{t-1}_{yy}\omega^{t-1}_{yz} \right) \right] \right\}\]" src="form_52.png"/>
</p>
<p>The velocity at time <img class="formulaInl" alt="$t$" src="form_23.png"/> only appears in the <img class="formulaInl" alt="$z$" src="form_43.png"/> component equation. Therefore, we will only solve said equation. In terms of <img class="formulaInl" alt="$v_z$" src="form_53.png"/> the equation is: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\partial_x \left(\eta_{ef}\partial_x v_z \right) + \partial_y \left(\eta_{ef}\partial_y v_z \right) = f^e_z \]" src="form_54.png"/>
</p>
<p>and for uniform effective viscosity we obtain the Poisson equation:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\eta_{ef}\Delta v_z = f^e_z \]" src="form_55.png"/>
</p>
<h1><a class="anchor" id="model"></a>
Modeling</h1>
<h2><a class="anchor" id="setup"></a>
Setup</h2>
<p>Here we will solve the visco-elastic equation in a two-dimensional domain of dimensions <img class="formulaInl" alt="$a$" src="form_56.png"/> by <img class="formulaInl" alt="$b$" src="form_57.png"/>. We will solve for the velocity in the direction perpendicular to the plane <img class="formulaInl" alt="$(v_z)$" src="form_58.png"/> caused by a fault also perpendicular to the modeled plane.</p>
<p>There are four possible boundary conditions:</p>
<ul>
<li><img class="formulaInl" alt="$\Gamma_0$" src="form_59.png"/> - The locked part above the fault, with imposed zero velocity, <img class="formulaInl" alt="$v_z=0$" src="form_60.png"/> (homogeneous Dirichlet boundary conditions).</li>
<li><img class="formulaInl" alt="$\Gamma_1$" src="form_61.png"/> - Regions of imposed velocity, <img class="formulaInl" alt="$v_z=V$" src="form_62.png"/> (non-homogeneous Dirichlet boundary conditions).</li>
<li><img class="formulaInl" alt="$\Gamma_2$" src="form_63.png"/> - Zero tangential stress boundaries, <img class="formulaInl" alt="$\boldsymbol{n} \cdot \tau - P =0$" src="form_64.png"/> (homogeneous Neumann boundary conditions).</li>
<li><img class="formulaInl" alt="$\Gamma_3$" src="form_65.png"/> - Imposed tangential stress <img class="formulaInl" alt="$\boldsymbol{n} \cdot \tau - P =S$" src="form_66.png"/> (non-homogeneous Neumann boundary conditions).</li>
</ul>
<h2><a class="anchor" id="weak_form"></a>
The Weak Form</h2>
<p>In order to solve the equation using the Finite Element Method we need to derive the weak form. We will begin with the partial differential equation that governs the velocity in a visco-elastic medium under the anti-plane shear approximation: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \nabla \left(\eta_{ef}\nabla v_z\right)=f^e_z\]" src="form_67.png"/>
</p>
<p>where i=1,2. First we multiply the equation from the left by a test function <img class="formulaInl" alt="$v$" src="form_68.png"/>, and then we integrate over the whole domain: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\int_{\Omega} v \cdot \nabla\left(\eta_{ef}\nabla v_z \right) = \int_{\Omega} v \cdot f^e_z \phi \]" src="form_69.png"/>
</p>
<p>Integrating by parts and using the Gauss theorem </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_{\Omega} \nabla v \cdot \eta_{ef}\nabla v_z = -\int_{\Omega} v \cdot f^e_z + \int_{\partial \Omega} v \cdot \eta_{ef} \boldsymbol{n} \nabla v_z \]" src="form_70.png"/>
</p>
<p>We can integrate by parts the term corresponding to the internal elastic force if we take into account that it is in fact the divergence of another function <img class="formulaInl" alt="$ f^e_z = -\partial_i g^e_{iz} $" src="form_71.png"/>. Therefore, we obtain: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_{\Omega} \nabla v \cdot \eta_{ef}\nabla v_z = -\int_{\Omega} \nabla v \cdot \boldsymbol{g^e_z} + \int_{\partial \Omega} v \cdot \eta_{ef} \boldsymbol{n} \nabla v_z + \int_{\partial \Omega} v \cdot \boldsymbol{n} \boldsymbol{g^e_z} \]" src="form_72.png"/>
</p>
<p>Considering that the boundary terms are related to the stress tensor <img class="formulaInl" alt="$ \tau_{ij}$" src="form_73.png"/> we obtain: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_{\Omega} \nabla v \cdot \eta_{ef}\nabla v_z = -\int_{\Omega} \nabla v \cdot \boldsymbol{g^e_z} + \int_{\partial \Omega} v \cdot \boldsymbol{n} \tau_{iz} \]" src="form_74.png"/>
</p>
<p>or: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left( \nabla v, \eta_{ef}\nabla v_z \right)_{\Omega} = - \left( \nabla v, \boldsymbol{g^e_z} \right)_{\Omega} + \left(v, \boldsymbol{n} \boldsymbol{\tau_{z}} \right)_{\partial \Omega} \]" src="form_75.png"/>
</p>
<p>where <img class="formulaInl" alt="$\boldsymbol{\tau_{z}} = \tau_{iz}$" src="form_76.png"/>.</p>
<p>In those boundaries where the velocity is imposed (Dirichlet boundary conditions), this is <img class="formulaInl" alt="$\Gamma_0$" src="form_59.png"/> and <img class="formulaInl" alt="$\Gamma_1$" src="form_61.png"/>,the test function <img class="formulaInl" alt="$v = 0$" src="form_77.png"/>. The contribution of those boundaries in which the imposed tangential stress is zero (i.e., <img class="formulaInl" alt="$\Gamma_2$" src="form_63.png"/>) will not contribute to the right hand side either. On the other hand,those boundaries in which we impose a non-zero tangential stress (non-homogeneous Neumann boundary conditions), this is <img class="formulaInl" alt="$\Gamma_3$" src="form_65.png"/>, the test functions <img class="formulaInl" alt="$v \neq 0$" src="form_78.png"/>, and that part of the boundary integral has to be included in the weak form. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left( \nabla v, \eta_{ef}\nabla v_z \right)_{\Omega} = - \left( \nabla v, \boldsymbol{g^e_z} \right)_{\Omega} + \left(v, S \right)_{\Gamma^3} \]" src="form_79.png"/>
</p>
<p>where the operator <img class="formulaInl" alt="$(a, b)$" src="form_80.png"/> is <img class="formulaInl" alt="$ \int a \cdot b $" src="form_81.png"/> and <img class="formulaInl" alt="$S$" src="form_82.png"/> is the imposed tangential stress at the boundary.</p>
<p>We can now replace the exact solution <img class="formulaInl" alt="$ v_z $" src="form_83.png"/> for an approximate solution in terms of the shape functions, <img class="formulaInl" alt="$ \sum_{j} U_j v_j(\boldsymbol{x}) $" src="form_84.png"/>. Here <img class="formulaInl" alt="$U_j$" src="form_85.png"/> are the expansion coefficients we need to determine to find the approximate solution to the laplace equation. Then, the problem is reduced to solving </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[AU=B\]" src="form_86.png"/>
</p>
<p> where the matrix A and the vector B are defined as: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[A_{ij} = (v_i,v_j)_{\Omega}\]" src="form_87.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[B_i = -(\nabla v_i, \boldsymbol{g^e_z})_\Omega + (v_i, S)_{\Gamma_3} \]" src="form_88.png"/>
</p>
<h2><a class="anchor" id="adaptive_refinement"></a>
Adaptive Mesh Refinement in Time Dependent Problems</h2>
<p>Every time step we need to use the solution from the two last time steps and the visco-elastic stress from the previous one. The old solutions are stored in a <a href="https://www.dealii.org/8.4.0/doxygen/deal.II/classVector.html">Vector</a> with as many elements as the degrees of freedom the problem has. The old stress is stored at each quadrature and can be accessed through a user pointer that each cell holds. Every time the mesh is refined, the number of cells and degrees of freedom changes, therefore, as part of the mesh refinement we need to transfer the solution vectors and the old stress from the old mesh to the new one. For the solution vectors we just need to use <a href="https://www.dealii.org/8.4.0/doxygen/deal.II/classSolutionTransfer.html">SolutionTransfer</a> (see for example <a href="https://www.dealii.org/8.2.0/doxygen/deal.II/step_26.html#codeHeatEquationrefine_meshcode">Step-26</a>).</p>
<p>Transferring the old stress is slightly more complicated, we need to transfer the data sotred in the quadrature points to a finite element field that is defined everywhere so that we can later transfer it to the new mesh (using <a href="https://www.dealii.org/8.4.0/doxygen/deal.II/classSolutionTransfer.html">SolutionTransfer</a> and then interpolate it to the new quadrature points. We need a discontinuous field that matches the values in the quadrature points (we will use a Discontinuous Galerking finite element <a href="https://www.dealii.org/8.2.0/doxygen/deal.II/classFE__DGQ.html">FE_DGQ</a>). </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 13 2016 16:21:08 for Viscoelastic Fault -  Viscous approach by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
